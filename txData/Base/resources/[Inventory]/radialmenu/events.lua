Variations = {
    Jackets = { Male = {}, Female = {} },
    Hair = { Male = {}, Female = {} },
    Bags = { Male = {}, Female = {} },
    Visor = { Male = {}, Female = {} },
    Gloves = {
        Male = {
            [16] = 4,
            [17] = 4,
            [18] = 4,
            [19] = 0,
            [20] = 1,
            [21] = 2,
            [22] = 4,
            [23] = 5,
            [24] = 6,
            [25] = 8,
            [26] = 11,
            [27] = 12,
            [28] = 14,
            [29] = 15,
            [30] = 0,
            [31] = 1,
            [32] = 2,
            [33] = 4,
            [34] = 5,
            [35] = 6,
            [36] = 8,
            [37] = 11,
            [38] = 12,
            [39] = 14,
            [40] = 15,
            [41] = 0,
            [42] = 1,
            [43] = 2,
            [44] = 4,
            [45] = 5,
            [46] = 6,
            [47] = 8,
            [48] = 11,
            [49] = 12,
            [50] = 14,
            [51] = 15,
            [52] = 0,
            [53] = 1,
            [54] = 2,
            [55] = 4,
            [56] = 5,
            [57] = 6,
            [58] = 8,
            [59] = 11,
            [60] = 12,
            [61] = 14,
            [62] = 15,
            [63] = 0,
            [64] = 1,
            [65] = 2,
            [66] = 4,
            [67] = 5,
            [68] = 6,
            [69] = 8,
            [70] = 11,
            [71] = 12,
            [72] = 14,
            [73] = 15,
            [74] = 0,
            [75] = 1,
            [76] = 2,
            [77] = 4,
            [78] = 5,
            [79] = 6,
            [80] = 8,
            [81] = 11,
            [82] = 12,
            [83] = 14,
            [84] = 15,
            [85] = 0,
            [86] = 1,
            [87] = 2,
            [88] = 4,
            [89] = 5,
            [90] = 6,
            [91] = 8,
            [92] = 11,
            [93] = 12,
            [94] = 14,
            [95] = 15,
            [96] = 4,
            [97] = 4,
            [98] = 4,
            [99] = 0,
            [100] = 1,
            [101] = 2,
            [102] = 4,
            [103] = 5,
            [104] = 6,
            [105] = 8,
            [106] = 11,
            [107] = 12,
            [108] = 14,
            [109] = 15,
            [110] = 4,
            [111] = 4,
            [115] = 112,
            [116] = 112,
            [117] = 112,
            [118] = 112,
            [119] = 112,
            [120] = 112,
            [121] = 112,
            [122] = 113,
            [123] = 113,
            [124] = 113,
            [125] = 113,
            [126] = 113,
            [127] = 113,
            [128] = 113,
            [129] = 114,
            [130] = 114,
            [131] = 114,
            [132] = 114,
            [133] = 114,
            [134] = 114,
            [135] = 114,
            [136] = 15,
            [137] = 15,
            [138] = 0,
            [139] = 1,
            [140] = 2,
            [141] = 4,
            [142] = 5,
            [143] = 6,
            [144] = 8,
            [145] = 11,
            [146] = 12,
            [147] = 14,
            [148] = 112,
            [149] = 113,
            [150] = 114,
            [151] = 0,
            [152] = 1,
            [153] = 2,
            [154] = 4,
            [155] = 5,
            [156] = 6,
            [157] = 8,
            [158] = 11,
            [159] = 12,
            [160] = 14,
            [161] = 112,
            [162] = 113,
            [163] = 114,
            [165] = 4,
            [166] = 4,
            [167] = 4,
        },
        Female = {
            [16] = 11,
            [17] = 3,
            [18] = 3,
            [19] = 3,
            [20] = 0,
            [21] = 1,
            [22] = 2,
            [23] = 3,
            [24] = 4,
            [25] = 5,
            [26] = 6,
            [27] = 7,
            [28] = 9,
            [29] = 11,
            [30] = 12,
            [31] = 14,
            [32] = 15,
            [33] = 0,
            [34] = 1,
            [35] = 2,
            [36] = 3,
            [37] = 4,
            [38] = 5,
            [39] = 6,
            [40] = 7,
            [41] = 9,
            [42] = 11,
            [43] = 12,
            [44] = 14,
            [45] = 15,
            [46] = 0,
            [47] = 1,
            [48] = 2,
            [49] = 3,
            [50] = 4,
            [51] = 5,
            [52] = 6,
            [53] = 7,
            [54] = 9,
            [55] = 11,
            [56] = 12,
            [57] = 14,
            [58] = 15,
            [59] = 0,
            [60] = 1,
            [61] = 2,
            [62] = 3,
            [63] = 4,
            [64] = 5,
            [65] = 6,
            [66] = 7,
            [67] = 9,
            [68] = 11,
            [69] = 12,
            [70] = 14,
            [71] = 15,
            [72] = 0,
            [73] = 1,
            [74] = 2,
            [75] = 3,
            [76] = 4,
            [77] = 5,
            [78] = 6,
            [79] = 7,
            [80] = 9,
            [81] = 11,
            [82] = 12,
            [83] = 14,
            [84] = 15,
            [85] = 0,
            [86] = 1,
            [87] = 2,
            [88] = 3,
            [89] = 4,
            [90] = 5,
            [91] = 6,
            [92] = 7,
            [93] = 9,
            [94] = 11,
            [95] = 12,
            [96] = 14,
            [97] = 15,
            [98] = 0,
            [99] = 1,
            [100] = 2,
            [101] = 3,
            [102] = 4,
            [103] = 5,
            [104] = 6,
            [105] = 7,
            [106] = 9,
            [107] = 11,
            [108] = 12,
            [109] = 14,
            [110] = 15,
            [111] = 3,
            [112] = 3,
            [113] = 3,
            [114] = 0,
            [115] = 1,
            [116] = 2,
            [117] = 3,
            [118] = 4,
            [119] = 5,
            [120] = 6,
            [121] = 7,
            [122] = 9,
            [123] = 11,
            [124] = 12,
            [125] = 14,
            [126] = 15,
            [127] = 3,
            [128] = 3,
            [132] = 129,
            [133] = 129,
            [134] = 129,
            [135] = 129,
            [136] = 129,
            [137] = 129,
            [138] = 129,
            [139] = 130,
            [140] = 130,
            [141] = 130,
            [142] = 130,
            [143] = 130,
            [144] = 130,
            [145] = 130,
            [146] = 131,
            [147] = 131,
            [148] = 131,
            [149] = 131,
            [150] = 131,
            [151] = 131,
            [152] = 131,
            [154] = 153,
            [155] = 153,
            [156] = 153,
            [157] = 153,
            [158] = 153,
            [159] = 153,
            [160] = 153,
            [162] = 161,
            [163] = 161,
            [164] = 161,
            [165] = 161,
            [166] = 161,
            [167] = 161,
            [168] = 161,
            [169] = 15,
            [170] = 15,
            [171] = 0,
            [172] = 1,
            [173] = 2,
            [174] = 3,
            [175] = 4,
            [176] = 5,
            [177] = 6,
            [178] = 7,
            [179] = 9,
            [180] = 11,
            [181] = 12,
            [182] = 14,
            [183] = 129,
            [184] = 130,
            [185] = 131,
            [186] = 153,
            [187] = 0,
            [188] = 1,
            [189] = 2,
            [190] = 3,
            [191] = 4,
            [192] = 5,
            [193] = 6,
            [194] = 7,
            [195] = 9,
            [196] = 11,
            [197] = 12,
            [198] = 14,
            [199] = 129,
            [200] = 130,
            [201] = 131,
            [202] = 153,
            [203] = 161,
            [204] = 161,
            [206] = 3,
            [207] = 3,
            [208] = 3,
        }
    }
}

RegisterNetEvent("radial:engine")
AddEventHandler("radial:engine", function()
    local ped = PlayerPedId()
    local vehicle = GetVehiclePedIsIn(ped, false)
    if vehicle ~= 0 then
        if GetPedInVehicleSeat(vehicle, -1) == ped then
            exports['mythic_progbar']:Progress({
                name = "engine",
                duration = 1000,
                label = not GetIsVehicleEngineRunning(vehicle) and "A ligar..." or "A desligar...",
                useWhileDead = false,
                canCancel = false,
                controlDisables = {},
                prop = {},
            }, function(wasCancelled)
            end)
            SetVehicleEngineOn(vehicle, (not GetIsVehicleEngineRunning(vehicle)), false, true)
        end
    end
end)

RegisterNetEvent("radial:lock")
AddEventHandler("radial:lock", function()
    TriggerEvent("esx_vehiclelock:use", true)
end)

RegisterNetEvent("radial:unlock")
AddEventHandler("radial:unlock", function()
    TriggerEvent("esx_vehiclelock:use", false)
end)

RegisterNetEvent("radial:moreop")
AddEventHandler("radial:moreop", function()
    exports["vehcontrol"]:openExternal()
end)

RegisterNetEvent("radial:cuffh")
AddEventHandler("radial:cuffh", function()
    TriggerEvent("ak47_crime:cuff:hard")
end)

RegisterNetEvent("radial:cuffs")
AddEventHandler("radial:cuffs", function()
    TriggerEvent("ak47_crime:cuff:soft")
end)

RegisterNetEvent("radial:uncuff")
AddEventHandler("radial:uncuff", function()
    TriggerEvent("ak47_crime:cuff:uncuff")
end)

RegisterNetEvent("radial:putpersontrunk")
AddEventHandler("radial:putpersontrunk", function()
    TriggerEvent("ak47_crime:trunk:forcein:radial")
end)

RegisterNetEvent("radial:removepersontrunk")
AddEventHandler("radial:removepersontrunk", function()
    TriggerEvent("ak47_crime:trunk:forceout:radial")
end)

RegisterNetEvent("radial:entertrunk")
AddEventHandler("radial:entertrunk", function()
    TriggerEvent("ak47_crime:trunk:in")
end)

RegisterNetEvent("radial:exittrunk")
AddEventHandler("radial:exittrunk", function()
    TriggerEvent("ak47_crime:trunk:out")
end)

RegisterNetEvent("radial:drag")
AddEventHandler("radial:drag", function()
    TriggerEvent("ak47_crime:drag:action")
end)

RegisterNetEvent("radial:putinvehicle")
AddEventHandler("radial:putinvehicle", function()
    TriggerEvent('ak47_crime:putInVehicle:action')
end)

RegisterNetEvent("radial:outthevehicle")
AddEventHandler("radial:outthevehicle", function()
    TriggerEvent('ak47_crime:OutVehicle:action')
end)

RegisterNetEvent("radial:sendBill:DPLS")
AddEventHandler("radial:sendBill:DPLS", function()
    ESX.UI.Menu.Open("dialog", GetCurrentResourceName(), 'send_billreason', {
        title = "Motivo da multa"
    }, function(data, menu)
        local reason = data.value
        if reason == nil or reason == "" then
            ESX.ShowNotification("FATURAS", "Motivo inválido", 2000, "error")
        else
            menu.close()
            ESX.UI.Menu.Open("dialog", GetCurrentResourceName(), 'send_billamount', {
                title = "Valor da multa"
            }, function(data2, menu2)
                local amount = tonumber(data2.value)
                if amount == nil or amount <= 0 then
                    ESX.ShowNotification("FATURAS", "Valor inválido", 2000, "error")
                else
                    menu2.close()
                    local player, distance = ESX.Game.GetClosestPlayer()
                    if distance ~= -1 and distance <= 3.0 then
                        TriggerServerEvent("esx_billing:sendBill", GetPlayerServerId(player), 'society_police', reason,
                            amount)
                    else
                        ESX.ShowNotification("FATURAS", "Nenhum jogador por perto", 2000, "warning")
                    end
                end
            end, function(data2, menu2)
                menu2.close()
            end)
        end
    end, function(data, menu)
        menu.close()
    end)
end)

RegisterNetEvent("radial:sendBill:SEM")
AddEventHandler("radial:sendBill:SEM", function()
    ESX.UI.Menu.Open("dialog", GetCurrentResourceName(), 'send_billreason', {
        title = "Motivo da fatura"
    }, function(data, menu)
        local reason = data.value
        if reason == nil or reason == "" then
            ESX.ShowNotification("FATURAS", "Motivo inválido", 2000, "error")
        else
            menu.close()
            ESX.UI.Menu.Open("dialog", GetCurrentResourceName(), 'send_billamount', {
                title = "Valor da fatura"
            }, function(data2, menu2)
                local amount = tonumber(data2.value)
                if amount == nil or amount <= 0 then
                    ESX.ShowNotification("FATURAS", "Valor inválido", 2000, "error")
                else
                    menu2.close()
                    local player, distance = ESX.Game.GetClosestPlayer()
                    if distance ~= -1 and distance <= 3.0 then
                        TriggerServerEvent("esx_billing:sendBill", GetPlayerServerId(player), 'society_ambulance', reason
                            , amount)
                    else
                        ESX.ShowNotification("FATURAS", "Nenhum jogador por perto", 2000, "warning")
                    end
                end
            end, function(data2, menu2)
                menu2.close()
            end)
        end
    end, function(data, menu)
        menu.close()
    end)
end)

RegisterNetEvent("radial:SEM:revive")
AddEventHandler("radial:SEM:revive", function()
    isBusy = true

    ESX.TriggerServerCallback('esx_ambulancejob:hasItem', function(bool)
        if bool then
            local closestPlayer = ESX.Game.GetClosestPlayer()
            local closestPlayerPed = GetPlayerPed(closestPlayer)

            if IsPedDeadOrDying(GetPlayerPed(closestPlayerPed), 1) then
                local playerPed = PlayerPedId()
                local lib, anim = 'mini@cpr@char_a@cpr_str', 'cpr_pumpchest'
                ESX.ShowNotification("SEM", 'Reanimação em andamento', 2000, "info")

                for i = 1, 15 do
                    Wait(900)

                    ESX.Streaming.RequestAnimDict(lib, function()
                        TaskPlayAnim(playerPed, lib, anim, 8.0, -8.0, -1, 0, 0.0, false, false, false)
                        RemoveAnimDict(lib)
                    end)
                end

                TriggerServerEvent('esx_ambulancejob:removeItem', 'medikit')
                TriggerServerEvent('esx_ambulancejob:revive', GetPlayerServerId(closestPlayer))
            else
                ESX.ShowNotification("SEM", 'O jogador não está inconsciente', 2000, "warning")
            end
        else
            ESX.ShowNotification("SEM", 'Não tens Kit Médico', 2000, "error")
        end
        isBusy = false
    end, 'medikit')
end)

RegisterNetEvent("radial:SEM:heal")
AddEventHandler("radial:SEM:heal", function()
    ESX.TriggerServerCallback('esx_ambulancejob:hasItem', function(bool)
        if bool then
            local closestPlayer, closestDistance = ESX.Game.GetClosestPlayer()
            local closestPlayerPed = GetPlayerPed(closestPlayer)
            local health = GetEntityHealth(closestPlayerPed)

            if health > 0 then
                local playerPed = PlayerPedId()

                isBusy = true
                ESX.ShowNotification("SEM", "Curamento em progresso", 2000, "info")
                TaskStartScenarioInPlace(playerPed, 'CODE_HUMAN_MEDIC_TEND_TO_DEAD', 0, true)
                Wait(10000)
                ClearPedTasks(playerPed)

                TriggerServerEvent('esx_ambulancejob:removeItem', 'bandage')
                TriggerServerEvent('esx_ambulancejob:heal', GetPlayerServerId(closestPlayer), 'small')
                ESX.ShowNotification("SEM", "Curamento concluído", 2000, "success")
                isBusy = false
            else
                ESX.ShowNotification("SEM", "O jogador não está consciente", 2000, "warning")
            end
        else
            ESX.ShowNotification("SEM", "Não tens Bandagens", 2000, "error")
        end
    end, 'bandage')
end)

RegisterNetEvent("radial:cc:see")
AddEventHandler("radial:cc:see", function()
    TriggerServerEvent("jsfour-idcard:open", GetPlayerServerId(PlayerId()), GetPlayerServerId(PlayerId()), nil)
end)

RegisterNetEvent("radial:cc:show")
AddEventHandler("radial:cc:show", function()
    local closestPlayer, closestDistance = ESX.Game.GetClosestPlayer()
    if closestPlayer == -1 or closestDistance > 3.0 then
        ESX.ShowNotification("CARTÃO DE CIDADÃO", "Nenhum jogador por perto", 2000, "warning")
    else
        TriggerServerEvent("jsfour-idcard:open", GetPlayerServerId(PlayerId()), GetPlayerServerId(closestPlayer), nil)
    end
end)

RegisterNetEvent("radial:driver:see")
AddEventHandler("radial:driver:see", function()
    TriggerServerEvent("jsfour-idcard:open", GetPlayerServerId(PlayerId()), GetPlayerServerId(PlayerId()), "driver")
end)

RegisterNetEvent("radial:driver:show")
AddEventHandler("radial:driver:show", function()
    local closestPlayer, closestDistance = ESX.Game.GetClosestPlayer()
    if closestPlayer == -1 or closestDistance > 3.0 then
        ESX.ShowNotification("CARTÃO DE CIDADÃO", "Nenhum jogador por perto", 2000, "warning")
    else
        TriggerServerEvent("jsfour-idcard:open", GetPlayerServerId(PlayerId()), GetPlayerServerId(closestPlayer),
            "driver")
    end
end)

RegisterNetEvent("radial:firearm:see")
AddEventHandler("radial:firearm:see", function()
    TriggerServerEvent("jsfour-idcard:open", GetPlayerServerId(PlayerId()), GetPlayerServerId(PlayerId()), "weapon")
end)

RegisterNetEvent("radial:firearm:show")
AddEventHandler("radial:firearm:show", function()
    local closestPlayer, closestDistance = ESX.Game.GetClosestPlayer()
    if closestPlayer == -1 or closestDistance > 3.0 then
        ESX.ShowNotification("LICENÇA DE PORTE DE ARMA", "Nenhum jogador por perto", 2000, "warning")
    else
        TriggerServerEvent("jsfour-idcard:open", GetPlayerServerId(PlayerId()), GetPlayerServerId(closestPlayer),
            "weapon")
    end
end)

RegisterNetEvent("radial:sendBill:MEC")
AddEventHandler("radial:sendBill:MEC", function()
    ESX.UI.Menu.Open("dialog", GetCurrentResourceName(), 'send_billreason', {
        title = "Motivo da fatura"
    }, function(data, menu)
        local reason = data.value
        if reason == nil or reason == "" then
            ESX.ShowNotification("FATURAS", "Motivo inválido", 2000, "error")
        else
            menu.close()
            ESX.UI.Menu.Open("dialog", GetCurrentResourceName(), 'send_billamount', {
                title = "Valor da fatura"
            }, function(data2, menu2)
                local amount = tonumber(data2.value)
                if amount == nil or amount <= 0 then
                    ESX.ShowNotification("FATURAS", "Valor inválido", 2000, "error")
                else
                    menu2.close()
                    local player, distance = ESX.Game.GetClosestPlayer()
                    if distance ~= -1 and distance <= 3.0 then
                        TriggerServerEvent("esx_billing:sendBill", GetPlayerServerId(player), 'society_mechanic', reason
                            , amount)
                    else
                        ESX.ShowNotification("FATURAS", "Nenhum jogador por perto", 2000, "warning")
                    end
                end
            end, function(data2, menu2)
                menu2.close()
            end)
        end
    end, function(data, menu)
        menu.close()
    end)
end)

RegisterNetEvent("radial:sendBill:SAUL")
AddEventHandler("radial:sendBill:SAUL", function()
    ESX.UI.Menu.Open("dialog", GetCurrentResourceName(), 'send_billreason', {
        title = "Motivo da fatura"
    }, function(data, menu)
        local reason = data.value
        if reason == nil or reason == "" then
            ESX.ShowNotification("FATURAS", "Motivo inválido", 2000, "error")
        else
            menu.close()
            ESX.UI.Menu.Open("dialog", GetCurrentResourceName(), 'send_billamount', {
                title = "Valor da fatura"
            }, function(data2, menu2)
                local amount = tonumber(data2.value)
                if amount == nil or amount <= 0 then
                    ESX.ShowNotification("FATURAS", "Valor inválido", 2000, "error")
                else
                    menu2.close()
                    local player, distance = ESX.Game.GetClosestPlayer()
                    if distance ~= -1 and distance <= 3.0 then
                        TriggerServerEvent("esx_billing:sendBill", GetPlayerServerId(player), 'society_lawyer', reason
                            , amount)
                    else
                        ESX.ShowNotification("FATURAS", "Nenhum jogador por perto", 2000, "warning")
                    end
                end
            end, function(data2, menu2)
                menu2.close()
            end)
        end
    end, function(data, menu)
        menu.close()
    end)
end)

RegisterNetEvent("radial:sendBill:GATO")
AddEventHandler("radial:sendBill:GATO", function()
    ESX.UI.Menu.Open("dialog", GetCurrentResourceName(), 'send_billreason', {
        title = "Motivo da fatura"
    }, function(data, menu)
        local reason = data.value
        if reason == nil or reason == "" then
            ESX.ShowNotification("FATURAS", "Motivo inválido", 2000, "error")
        else
            menu.close()
            ESX.UI.Menu.Open("dialog", GetCurrentResourceName(), 'send_billamount', {
                title = "Valor da fatura"
            }, function(data2, menu2)
                local amount = tonumber(data2.value)
                if amount == nil or amount <= 0 then
                    ESX.ShowNotification("FATURAS", "Valor inválido", 2000, "error")
                else
                    menu2.close()
                    local player, distance = ESX.Game.GetClosestPlayer()
                    if distance ~= -1 and distance <= 3.0 then
                        TriggerServerEvent("esx_billing:sendBill", GetPlayerServerId(player), 'society_gato', reason
                            , amount)
                    else
                        ESX.ShowNotification("FATURAS", "Nenhum jogador por perto", 2000, "warning")
                    end
                end
            end, function(data2, menu2)
                menu2.close()
            end)
        end
    end, function(data, menu)
        menu.close()
    end)
end)

RegisterNetEvent("radial:licenca")
AddEventHandler("radial:licenca", function()
    local closestPlayer, closestDistance = ESX.Game.GetClosestPlayer()
    if closestPlayer == -1 or closestDistance > 3.0 then
        ESX.ShowNotification("DPLS", "Nenhum jogador por perto", 2000, "warning")
    else
        local player = GetPlayerServerId(closestPlayer)
        ESX.TriggerServerCallback('radial:GetLicensesPlayerDoesntHave', function(licenses)
            local elements = {}
            for i = 1, #licenses, 1 do
                table.insert(elements, {
                    label = licenses[i].label,
                    value = licenses[i].type
                })
            end
            ESX.UI.Menu.Open("default", GetCurrentResourceName(), "dpls", {
                title = "DPLS",
                align = "top-left",
                elements = elements
            }, function(data, menu)
                TriggerServerEvent("esx_license:addLicense", player, data.current.value)
                ESX.ShowNotification("DPLS", "Deste a licença de " .. data.current.label .. " a " .. GetPlayerName(closestPlayer) .. "", 2000, "success")
                menu.close()
            end, function(data, menu)
                menu.close()
            end)
        end, player)
    end
end)

RegisterNetEvent("radial:clothes:reset")
AddEventHandler("radial:clothes:reset", function()
    ESX.TriggerServerCallback('esx_skin:getPlayerSkin', function(skin)
        TriggerEvent('skinchanger:loadSkin', skin)
    end)
end)

RegisterNetEvent("radial:getName")
AddEventHandler("radial:getName", function()
    local closestPlayer, closestDistance = ESX.Game.GetClosestPlayer()
    if closestPlayer == -1 or closestDistance > 3.0 then
        ESX.ShowNotification("DPLS", "Nenhum jogador por perto", 2000, "warning")
    else
        local player = GetPlayerServerId(closestPlayer)
        ESX.TriggerServerCallback('radial:getName', function(nome)
            ESX.ShowNotification("DPLS", "O nome do jogador é " .. nome .. "", 2000, "success")
        end, player)
    end
end)

RegisterNetEvent("radial:dpls:impressao")
AddEventHandler("radial:dpls:impressao", function()
    local closestPlayer, closestDistance = ESX.Game.GetClosestPlayer()
    if closestPlayer == -1 or closestDistance > 3.0 then
        ESX.ShowNotification("DPLS", "Nenhum jogador por perto", 2000, "warning")
    else
        local player = GetPlayerServerId(closestPlayer)
        ESX.TriggerServerCallback('radial:getName', function(nome)
            ESX.ShowNotification("DPLS", "O nome do jogador é " .. nome .. "", 2000, "success")
        end, player)
    end
end)

local Drawables = {
    ["Top"] = {
        Drawable = 11,
        Table = Variations.Jackets,
        Emote = { Dict = "missmic4", Anim = "michael_tux_fidget", Move = 51, Dur = 1500 }
    },
    ["Gloves"] = {
        Drawable = 3,
        Table = Variations.Gloves,
        Remember = true,
        Emote = { Dict = "nmt_3_rcm-10", Anim = "cs_nigel_dual-10", Move = 51, Dur = 1200 }
    },
    ["Shoes"] = {
        Drawable = 6,
        Table = { Standalone = true, Male = 34, Female = 35 },
        Emote = { Dict = "random@domestic", Anim = "pickup_low", Move = 0, Dur = 1200 }
    },
    ["Neck"] = {
        Drawable = 7,
        Table = { Standalone = true, Male = 0, Female = 0 },
        Emote = { Dict = "clothingtie", Anim = "try_tie_positive_a", Move = 51, Dur = 2100 }
    },
    ["Vest"] = {
        Drawable = 9,
        Table = { Standalone = true, Male = 0, Female = 0 },
        Emote = { Dict = "clothingtie", Anim = "try_tie_negative_a", Move = 51, Dur = 1200 }
    },
    ["Bag"] = {
        Drawable = 5,
        Table = Variations.Bags,
        Emote = { Dict = "anim@heists@ornate_bank@grab_cash", Anim = "intro", Move = 51, Dur = 1600 }
    },
    ["Mask"] = {
        Drawable = 1,
        Table = { Standalone = true, Male = 0, Female = 0 },
        Emote = { Dict = "mp_masks@standard_car@ds@", Anim = "put_on_mask", Move = 51, Dur = 800 }
    },
    ["Hair"] = {
        Drawable = 2,
        Table = Variations.Hair,
        Remember = true,
        Emote = { Dict = "clothingtie", Anim = "check_out_a", Move = 51, Dur = 2000 }
    },
}

local Extras = {
    ["Shirt"] = {
        Drawable = 11,
        Table = {
            Standalone = true, Male = 252, Female = 18,
            Extra = {
                { Drawable = 8, Id = 15, Tex = 0, Name = "Extra Undershirt" },
                { Drawable = 3, Id = 15, Tex = 0, Name = "Extra Gloves" },
                { Drawable = 10, Id = 0, Tex = 0, Name = "Extra Decals" },
            }
        },
        Emote = { Dict = "clothingtie", Anim = "try_tie_negative_a", Move = 51, Dur = 1200 }
    },
    ["Pants"] = {
        Drawable = 4,
        Table = { Standalone = true, Male = 61, Female = 17 },
        Emote = { Dict = "re@construction", Anim = "out_of_breath", Move = 51, Dur = 1300 }
    },
    ["Bagoff"] = {
        Drawable = 5,
        Table = { Standalone = true, Male = 0, Female = 0 },
        Emote = { Dict = "clothingtie", Anim = "try_tie_negative_a", Move = 51, Dur = 1200 }
    },
}

local Props = {
    ["Visor"] = {
        Prop = 0,
        Variants = Variations.Visor,
        Emote = {
            On = { Dict = "mp_masks@standard_car@ds@", Anim = "put_on_mask", Move = 51, Dur = 600 },
            Off = { Dict = "missheist_agency2ahelmet", Anim = "take_off_helmet_stand", Move = 51, Dur = 1200 }
        }
    },
    ["Hat"] = {
        Prop = 0,
        Emote = {
            On = { Dict = "mp_masks@standard_car@ds@", Anim = "put_on_mask", Move = 51, Dur = 600 },
            Off = { Dict = "missheist_agency2ahelmet", Anim = "take_off_helmet_stand", Move = 51, Dur = 1200 }
        }
    },
    ["Glasses"] = {
        Prop = 1,
        Emote = {
            On = { Dict = "clothingspecs", Anim = "take_off", Move = 51, Dur = 1400 },
            Off = { Dict = "clothingspecs", Anim = "take_off", Move = 51, Dur = 1400 }
        }
    },
    ["Ear"] = {
        Prop = 2,
        Emote = {
            On = { Dict = "mp_cp_stolen_tut", Anim = "b_think", Move = 51, Dur = 900 },
            Off = { Dict = "mp_cp_stolen_tut", Anim = "b_think", Move = 51, Dur = 900 }
        }
    },
    ["Watch"] = {
        Prop = 6,
        Emote = {
            On = { Dict = "nmt_3_rcm-10", Anim = "cs_nigel_dual-10", Move = 51, Dur = 1200 },
            Off = { Dict = "nmt_3_rcm-10", Anim = "cs_nigel_dual-10", Move = 51, Dur = 1200 }
        }
    },
    ["Bracelet"] = {
        Prop = 7,
        Emote = {
            On = { Dict = "nmt_3_rcm-10", Anim = "cs_nigel_dual-10", Move = 51, Dur = 1200 },
            Off = { Dict = "nmt_3_rcm-10", Anim = "cs_nigel_dual-10", Move = 51, Dur = 1200 }
        }
    },
}

LastEquipped = {}
Cooldown = false

function IsMpPed(ped)
    local Male = GetHashKey("mp_m_freemode_01")
    local Female = GetHashKey("mp_f_freemode_01")
    local CurrentModel = GetEntityModel(ped)
    if CurrentModel == Male then return "Male" elseif CurrentModel == Female then return "Female" else return false end
end

function IncurCooldown(ms)
    Citizen.CreateThread(function()
        Cooldown = true
        Wait(ms)
        Cooldown = false
    end)
end

local function PlayToggleEmote(e, cb)
    local Ped = PlayerPedId()
    while not HasAnimDictLoaded(e.Dict) do RequestAnimDict(e.Dict) Wait(100) end
    if IsPedInAnyVehicle(Ped) then e.Move = 51 end
    TaskPlayAnim(Ped, e.Dict, e.Anim, 3.0, 3.0, e.Dur, e.Move, 0, false, false, false)
    local Pause = e.Dur - 500
    if Pause < 500 then Pause = 500 end
    IncurCooldown(Pause)
    Wait(Pause) -- Lets wait for the emote to play for a bit then do the callback.
    cb()
end

function ToggleClothing(which, extra)
    if Cooldown then return end
    local Toggle = Drawables[which]
    if extra then Toggle = Extras[which] end
    local Ped = PlayerPedId()
    local Cur = {
        Drawable = GetPedDrawableVariation(Ped, Toggle.Drawable),
        Id = Toggle.Drawable,
        Ped = Ped,
        Texture = GetPedTextureVariation(Ped, Toggle.Drawable),
    }
    local Gender = IsMpPed(Ped)
    if which ~= "Mask" then
        if not Gender then ESX.ShowNotification("ROUPA", "Ped não permitido", 2000, 'error') return false end
    end
    local Table = Toggle.Table[Gender]
    if not Toggle.Table.Standalone then
        for k, v in pairs(Table) do
            if not Toggle.Remember then
                if k == Cur.Drawable then
                    PlayToggleEmote(Toggle.Emote,
                        function() SetPedComponentVariation(Ped, Toggle.Drawable, v, Cur.Texture, 0) end)
                    return true
                end
            else
                if not LastEquipped[which] then
                    if k == Cur.Drawable then
                        PlayToggleEmote(Toggle.Emote,
                            function() LastEquipped[which] = Cur
                                SetPedComponentVariation(Ped, Toggle.Drawable, v,
                                    Cur.Texture, 0)
                            end)
                        return true
                    end
                else
                    local Last = LastEquipped[which]
                    PlayToggleEmote(Toggle.Emote,
                        function() SetPedComponentVariation(Ped, Toggle.Drawable, Last.Drawable, Last.Texture, 0)
                            LastEquipped
                                [which] = false
                        end)
                    return true
                end
            end
        end
        ESX.ShowNotification("ROUPA", "Não há variações", 2000, 'warning')
        return
    else
        if not LastEquipped[which] then
            if Cur.Drawable ~= Table then
                PlayToggleEmote(Toggle.Emote, function()
                    LastEquipped[which] = Cur
                    SetPedComponentVariation(Ped, Toggle.Drawable, Table, 0, 0)
                    if Toggle.Table.Extra then
                        local Extras = Toggle.Table.Extra
                        for k, v in pairs(Extras) do
                            local ExtraCur = { Drawable = GetPedDrawableVariation(Ped, v.Drawable),
                                Texture = GetPedTextureVariation(Ped, v.Drawable), Id = v.Drawable }
                            SetPedComponentVariation(Ped, v.Drawable, v.Id, v.Tex, 0)
                            LastEquipped[v.Name] = ExtraCur
                        end
                    end
                end)
                return true
            end
        else
            local Last = LastEquipped[which]
            PlayToggleEmote(Toggle.Emote, function()
                SetPedComponentVariation(Ped, Toggle.Drawable, Last.Drawable, Last.Texture, 0)
                LastEquipped[which] = false
                if Toggle.Table.Extra then
                    local Extras = Toggle.Table.Extra
                    for k, v in pairs(Extras) do
                        if LastEquipped[v.Name] then
                            local Last = LastEquipped[v.Name]
                            SetPedComponentVariation(Ped, Last.Id, Last.Drawable, Last.Texture, 0)
                            LastEquipped[v.Name] = false
                        end
                    end
                end
            end)
            return true
        end
    end
    ESX.ShowNotification("ROUPA", "Já estás a vestir isso", 2000, 'warning')
    return false
end

function ToggleProps(which)
    if Cooldown then return end
    local Prop = Props[which]
    local Ped = PlayerPedId()
    local Gender = IsMpPed(Ped)
    local Cur = { -- Lets get out currently equipped prop.
        Id = Prop.Prop,
        Ped = Ped,
        Prop = GetPedPropIndex(Ped, Prop.Prop),
        Texture = GetPedPropTextureIndex(Ped, Prop.Prop),
    }
    if not Prop.Variants then
        if Cur.Prop ~= -1 then
            PlayToggleEmote(Prop.Emote.Off, function() LastEquipped[which] = Cur ClearPedProp(Ped, Prop.Prop) end)
            return true
        else
            local Last = LastEquipped[which]
            if Last then
                PlayToggleEmote(Prop.Emote.On,
                    function() SetPedPropIndex(Ped, Prop.Prop, Last.Prop, Last.Texture, true) end)
                LastEquipped[which] = false
                return true
            end
        end
        ESX.ShowNotification("ROUPA", "Nada a remover", 2000, 'warning')
        return false
    else
        local Gender = IsMpPed(Ped)
        if not Gender then ESX.ShowNotification("ROUPA", "Ped não permitido", 2000, 'error') return false end
        local Variations = Prop.Variants[Gender]
        for k, v in pairs(Variations) do
            if Cur.Prop == k then
                PlayToggleEmote(Prop.Emote.On, function() SetPedPropIndex(Ped, Prop.Prop, v, Cur.Texture, true) end)
                return true
            end
        end
        ESX.ShowNotification("ROUPA", "Não há variações", 2000, 'warning')
        return false
    end
end

local commands = {
    {
        Func = function() ToggleClothing("Top") end,
        Name = "top",
    },
    {
        Func = function() ToggleClothing("Gloves") end,
        Name = "luvas",
    },
    {
        Func = function() ToggleProps("Visor") end,
        Name = "visor",
    },
    {
        Func = function() ToggleClothing("Bag") end,
        Name = "mochila",
    },
    {
        Func = function() ToggleClothing("Shoes") end,
        Name = "sapatos",
    },
    {
        Func = function() ToggleClothing("Vest") end,
        Name = "casaco",
    },
    {
        Func = function() ToggleClothing("Hair") end,
        Name = "cabelo",
    },
    {
        Func = function() ToggleProps("Hat") end,
        Name = "chapeu",
    },
    {
        Func = function() ToggleProps("Glasses") end,
        Name = "oculos",
    },
    {
        Func = function() ToggleProps("Ear") end,
        Name = "brincos",
    },
    {
        Func = function() ToggleClothing("Neck") end,
        Name = "pescoco",
    },
    {
        Func = function() ToggleProps("Watch") end,
        Name = "relogio",
    },
    {
        Func = function() ToggleProps("Bracelet") end,
        Name = "bracelete",
    },
    {
        Func = function() ToggleClothing("Mask") end,
        Name = "mascara",
    },
    {
        Func = function() ToggleClothing("Pants", true) end,
        Name = "calcas",
    },
    {
        Func = function() ToggleClothing("Shirt", true) end,
        Name = "tshirt",
    },
}

for k, v in pairs(commands) do
    RegisterCommand(v.Name, v.Func)
    TriggerEvent("chat:addSuggestion", "/" .. v.Name, "Mudar " .. v.Name)
    RegisterNetEvent("radial:clothing:" .. v.Name)
    AddEventHandler("radial:clothing:" .. v.Name, v.Func)
end

function AddNewVariation(which, gender, one, two, single)
    local Where = Variations[which][gender]
    if not single then
        Where[one] = two
        Where[two] = one
    else
        Where[one] = two
    end
end

Citizen.CreateThread(function()
    -- Male Visor/Hat Variations
    AddNewVariation("Visor", "Male", 9, 10)
    AddNewVariation("Visor", "Male", 18, 67)
    AddNewVariation("Visor", "Male", 82, 67)
    AddNewVariation("Visor", "Male", 44, 45)
    AddNewVariation("Visor", "Male", 50, 68)
    AddNewVariation("Visor", "Male", 51, 69)
    AddNewVariation("Visor", "Male", 52, 70)
    AddNewVariation("Visor", "Male", 53, 71)
    AddNewVariation("Visor", "Male", 62, 72)
    AddNewVariation("Visor", "Male", 65, 66)
    AddNewVariation("Visor", "Male", 73, 74)
    AddNewVariation("Visor", "Male", 76, 77)
    AddNewVariation("Visor", "Male", 79, 78)
    AddNewVariation("Visor", "Male", 80, 81)
    AddNewVariation("Visor", "Male", 91, 92)
    AddNewVariation("Visor", "Male", 104, 105)
    AddNewVariation("Visor", "Male", 109, 110)
    AddNewVariation("Visor", "Male", 116, 117)
    AddNewVariation("Visor", "Male", 118, 119)
    AddNewVariation("Visor", "Male", 123, 124)
    AddNewVariation("Visor", "Male", 125, 126)
    AddNewVariation("Visor", "Male", 127, 128)
    AddNewVariation("Visor", "Male", 130, 131)
    -- Female Visor/Hat Variations
    AddNewVariation("Visor", "Female", 43, 44)
    AddNewVariation("Visor", "Female", 49, 67)
    AddNewVariation("Visor", "Female", 64, 65)
    AddNewVariation("Visor", "Female", 65, 64)
    AddNewVariation("Visor", "Female", 51, 69)
    AddNewVariation("Visor", "Female", 50, 68)
    AddNewVariation("Visor", "Female", 52, 70)
    AddNewVariation("Visor", "Female", 62, 71)
    AddNewVariation("Visor", "Female", 72, 73)
    AddNewVariation("Visor", "Female", 75, 76)
    AddNewVariation("Visor", "Female", 78, 77)
    AddNewVariation("Visor", "Female", 79, 80)
    AddNewVariation("Visor", "Female", 18, 66)
    AddNewVariation("Visor", "Female", 66, 81)
    AddNewVariation("Visor", "Female", 81, 66)
    AddNewVariation("Visor", "Female", 86, 84)
    AddNewVariation("Visor", "Female", 90, 91)
    AddNewVariation("Visor", "Female", 103, 104)
    AddNewVariation("Visor", "Female", 108, 109)
    AddNewVariation("Visor", "Female", 115, 116)
    AddNewVariation("Visor", "Female", 117, 118)
    AddNewVariation("Visor", "Female", 122, 123)
    AddNewVariation("Visor", "Female", 124, 125)
    AddNewVariation("Visor", "Female", 126, 127)
    AddNewVariation("Visor", "Female", 129, 130)
    -- Male Bags
    AddNewVariation("Bags", "Male", 45, 44)
    AddNewVariation("Bags", "Male", 41, 40)
    -- Female Bags
    AddNewVariation("Bags", "Female", 45, 44)
    AddNewVariation("Bags", "Female", 41, 40)
    -- Male Hair
    AddNewVariation("Hair", "Male", 7, 15, true)
    AddNewVariation("Hair", "Male", 43, 15, true)
    AddNewVariation("Hair", "Male", 9, 43, true)
    AddNewVariation("Hair", "Male", 11, 43, true)
    AddNewVariation("Hair", "Male", 15, 43, true)
    AddNewVariation("Hair", "Male", 16, 43, true)
    AddNewVariation("Hair", "Male", 17, 43, true)
    AddNewVariation("Hair", "Male", 20, 43, true)
    AddNewVariation("Hair", "Male", 22, 43, true)
    AddNewVariation("Hair", "Male", 45, 43, true)
    AddNewVariation("Hair", "Male", 47, 43, true)
    AddNewVariation("Hair", "Male", 49, 43, true)
    AddNewVariation("Hair", "Male", 51, 43, true)
    AddNewVariation("Hair", "Male", 52, 43, true)
    AddNewVariation("Hair", "Male", 53, 43, true)
    AddNewVariation("Hair", "Male", 56, 43, true)
    AddNewVariation("Hair", "Male", 58, 43, true)
    -- Female Hair
    AddNewVariation("Hair", "Female", 1, 49, true)
    AddNewVariation("Hair", "Female", 2, 49, true)
    AddNewVariation("Hair", "Female", 7, 49, true)
    AddNewVariation("Hair", "Female", 9, 49, true)
    AddNewVariation("Hair", "Female", 10, 49, true)
    AddNewVariation("Hair", "Female", 11, 48, true)
    AddNewVariation("Hair", "Female", 14, 53, true)
    AddNewVariation("Hair", "Female", 15, 42, true)
    AddNewVariation("Hair", "Female", 21, 42, true)
    AddNewVariation("Hair", "Female", 23, 42, true)
    AddNewVariation("Hair", "Female", 31, 53, true)
    AddNewVariation("Hair", "Female", 39, 49, true)
    AddNewVariation("Hair", "Female", 40, 49, true)
    AddNewVariation("Hair", "Female", 42, 53, true)
    AddNewVariation("Hair", "Female", 45, 49, true)
    AddNewVariation("Hair", "Female", 48, 49, true)
    AddNewVariation("Hair", "Female", 49, 48, true)
    AddNewVariation("Hair", "Female", 52, 53, true)
    AddNewVariation("Hair", "Female", 53, 42, true)
    AddNewVariation("Hair", "Female", 54, 55, true)
    AddNewVariation("Hair", "Female", 59, 42, true)
    AddNewVariation("Hair", "Female", 59, 54, true)
    AddNewVariation("Hair", "Female", 68, 53, true)
    AddNewVariation("Hair", "Female", 76, 48, true)
    -- Male Top/Jacket Variations
    AddNewVariation("Jackets", "Male", 29, 30)
    AddNewVariation("Jackets", "Male", 31, 32)
    AddNewVariation("Jackets", "Male", 42, 43)
    AddNewVariation("Jackets", "Male", 68, 69)
    AddNewVariation("Jackets", "Male", 74, 75)
    AddNewVariation("Jackets", "Male", 87, 88)
    AddNewVariation("Jackets", "Male", 99, 100)
    AddNewVariation("Jackets", "Male", 101, 102)
    AddNewVariation("Jackets", "Male", 103, 104)
    AddNewVariation("Jackets", "Male", 126, 127)
    AddNewVariation("Jackets", "Male", 129, 130)
    AddNewVariation("Jackets", "Male", 184, 185)
    AddNewVariation("Jackets", "Male", 188, 189)
    AddNewVariation("Jackets", "Male", 194, 195)
    AddNewVariation("Jackets", "Male", 196, 197)
    AddNewVariation("Jackets", "Male", 198, 199)
    AddNewVariation("Jackets", "Male", 200, 203)
    AddNewVariation("Jackets", "Male", 202, 205)
    AddNewVariation("Jackets", "Male", 206, 207)
    AddNewVariation("Jackets", "Male", 210, 211)
    AddNewVariation("Jackets", "Male", 217, 218)
    AddNewVariation("Jackets", "Male", 229, 230)
    AddNewVariation("Jackets", "Male", 232, 233)
    AddNewVariation("Jackets", "Male", 251, 253)
    AddNewVariation("Jackets", "Male", 256, 261)
    AddNewVariation("Jackets", "Male", 262, 263)
    AddNewVariation("Jackets", "Male", 265, 266)
    AddNewVariation("Jackets", "Male", 267, 268)
    AddNewVariation("Jackets", "Male", 279, 280)
    -- Female Top/Jacket Variations
    AddNewVariation("Jackets", "Female", 53, 52)
    AddNewVariation("Jackets", "Female", 57, 58)
    AddNewVariation("Jackets", "Female", 62, 63)
    AddNewVariation("Jackets", "Female", 90, 91)
    AddNewVariation("Jackets", "Female", 92, 93)
    AddNewVariation("Jackets", "Female", 94, 95)
    AddNewVariation("Jackets", "Female", 187, 186)
    AddNewVariation("Jackets", "Female", 190, 191)
    AddNewVariation("Jackets", "Female", 196, 197)
    AddNewVariation("Jackets", "Female", 198, 199)
    AddNewVariation("Jackets", "Female", 200, 201)
    AddNewVariation("Jackets", "Female", 202, 205)
    AddNewVariation("Jackets", "Female", 204, 207)
    AddNewVariation("Jackets", "Female", 210, 211)
    AddNewVariation("Jackets", "Female", 214, 215)
    AddNewVariation("Jackets", "Female", 227, 228)
    AddNewVariation("Jackets", "Female", 239, 240)
    AddNewVariation("Jackets", "Female", 242, 243)
    AddNewVariation("Jackets", "Female", 259, 261)
    AddNewVariation("Jackets", "Female", 265, 270)
    AddNewVariation("Jackets", "Female", 271, 272)
    AddNewVariation("Jackets", "Female", 274, 275)
    AddNewVariation("Jackets", "Female", 276, 277)
    AddNewVariation("Jackets", "Female", 292, 293)
end)
